<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Loja do Operador</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
  <style>
    /* ====== MODAL DE CORES ====== */
    .modal-cores {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.8);
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }

    .modal-conteudo {
      background: #1c1c1c;
      border-radius: 12px;
      padding: 25px;
      width: 90%;
      max-width: 800px;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 0 20px rgba(249, 160, 27, 0.3);
    }

    .fechar-modal {
      float: right;
      font-size: 1.8rem;
      color: var(--cor-secundaria);
      cursor: pointer;
      transition: var(--transition);
    }

    .fechar-modal:hover {
      color: #fff;
    }

    .parte-personalizacao {
      margin-bottom: 20px;
      padding: 15px;
      background: #2a2a2a;
      border-radius: 8px;
    }

    .parte-titulo {
      color: var(--cor-secundaria);
      margin-bottom: 10px;
      font-size: 1.1rem;
    }

    .opcoes-materiais {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 15px;
      margin-top: 10px;
    }

    .material-card {
      background: #333;
      border-radius: 10px;
      text-align: center;
      cursor: pointer;
      transition: var(--transition);
      padding: 10px;
      border: 2px solid transparent;
    }

    .material-card:hover {
      transform: scale(1.05);
      border-color: var(--cor-secundaria);
    }

    .material-card.selecionado {
      border-color: var(--cor-secundaria);
      box-shadow: 0 0 10px rgba(249, 160, 27, 0.5);
    }

    .material-card img {
      width: 100%;
      height: 80px;
      object-fit: cover;
      border-radius: 8px;
    }

    .material-card span {
      display: block;
      margin-top: 5px;
      font-size: 0.85rem;
      color: var(--texto-claro);
    }

    .btn-confirmar-cores {
      background: var(--cor-secundaria);
      color: #000;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      transition: var(--transition);
      margin-top: 20px;
      width: 100%;
    }

    .btn-confirmar-cores:hover {
      transform: scale(1.02);
      background: #ffb347;
    }

    .resumo-personalizacao {
      background: #2a2a2a;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
    }

    .resumo-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-size: 0.9rem;
    }

    .resumo-item:last-child {
      margin-bottom: 0;
    }

    .seletor-chao {
      margin-top: 15px;
      padding: 10px;
      background: #333;
      border-radius: 8px;
    }

    .seletor-chao label {
      display: block;
      margin-bottom: 8px;
      color: var(--texto-claro);
    }

    .seletor-chao select {
      width: 100%;
      padding: 8px;
      border-radius: 6px;
      background: #2a2a2a;
      color: var(--texto-claro);
      border: 1px solid #444;
    }
  </style>
</head>
<body>
  
  <!-- üîù MENU FIXO RESPONSIVO -->
  <nav class="menu-topo">
    <div class="menu-logo">
      <img src="logo.png" alt="Logo" class="logo-menu">
      <span class="nome-site">Loja do Operador</span>
    </div>

    <div class="menu-toggle" id="menu-toggle">‚ò∞</div>

    <ul class="menu-links" id="menu-links">
      <li><a href="#home">Home</a></li>
      <li><a href="#kits">Kits</a></li>
      <li><a href="#contato">Contato</a></li>
    </ul>
  </nav>

  <!-- üè† CABE√áALHO -->
  <header id="home" class="header-reduzido">
    <h1 class="titulo-principal">INTERNAS PERSONALIZADA ‚Äî ENVIO PARA TODO BRASIL</h1>
    <p class="subtitulo-min">Escolha o kit ideal para sua m√°quina. Integra√ß√£o com WhatsApp para finalizar pedidos.</p>
  </header>

  <!-- üîÅ CARROSSEL DE KITS -->
  <section class="carousel-section" id="kits">
    <div class="swiper main-swiper">
      <div class="swiper-wrapper" id="slides-kits">
        <!-- Os slides ser√£o gerados dinamicamente pelo JavaScript -->
      </div>
      <div class="swiper-pagination"></div>
    </div>
  </section>

  <!-- ‚öôÔ∏è M√ÅQUINAS (ROLAGEM HORIZONTAL) -->
  <section id="selecao-container" class="maquinas-container">
    <h2>Selecione sua m√°quina</h2>
    <div class="maquinas-scroll">
      <div class="maquina-item" data-maquina="Escavadeira">
        <img src="imagens/icones/escavadeiraa.png" alt="Escavadeira">
        <p>Escavadeira</p>
      </div>
      <div class="maquina-item" data-maquina="Retro-Escavadeira">
        <img src="imagens/icones/retro-escavadeira.png" alt="Retro-Escavadeira">
        <p>Retro-Escavadeira</p>
      </div>
      <div class="maquina-item" data-maquina="Pa-Carregadeira">
        <img src="imagens/icones/pa-carregadeira.png" alt="Pa-Carregadeira">
        <p>Pa-Carregadeira</p>
      </div>
      <div class="maquina-item" data-maquina="Moto-Niveladora">
        <img src="imagens/icones/moto-niveladora.png" alt="Moto-Niveladora">
        <p>Moto-Niveladora</p>
      </div>
      <div class="maquina-item" data-maquina="Trator-Esteira">
        <img src="imagens/icones/trator-esteira.png" alt="Trator-Esteira">
        <p>Trator-Esteira</p>
      </div>
      <div class="maquina-item" data-maquina="Trator">
        <img src="imagens/icones/trator.png" alt="Trator">
        <p>Trator</p>
      </div>
      <div class="maquina-item" data-maquina="Pulverizador">
        <img src="imagens/icones/pulverizador.png" alt="Pulverizador">
        <p>Pulverizador</p>
      </div>
      <div class="maquina-item" data-maquina="Colheitadeira">
        <img src="imagens/icones/colheitadeira.png" alt="Colheitadeira">
        <p>Colheitadeira</p>
      </div>
      <div class="maquina-item" data-maquina="Mini-Escavadeira">
        <img src="imagens/icones/mini-escavadeira.png" alt="Mini-Escavadeira">
        <p>Mini-Escavadeira</p>
      </div>
      <div class="maquina-item" data-maquina="Mini-Carregadeira">
        <img src="imagens/icones/mini-carregadeira.png" alt="Mini-Carregadeira">
        <p>Mini-Carregadeira</p>
      </div>
    </div>

    <!-- üÜï CAMPOS DE INFORMA√á√ïES DA M√ÅQUINA -->
    <div id="maquina-detalhes" class="maquina-detalhes">
      <h3>Informa√ß√µes da M√°quina</h3>
      <div class="form-grid">
        <input type="text" id="maquina-marca" placeholder="Marca (ex: Caterpillar)" required>
        <input type="text" id="maquina-modelo" placeholder="Modelo (ex: 320D)" required>
        <input type="text" id="maquina-ano" placeholder="Ano (ex: 2020)" required>
      </div>
    </div>
  </section>

  <!-- üé® PERSONALIZA√á√ÉO -->
  <section id="personalizacao-container">
    <h2>Personaliza√ß√£o do Kit</h2>
    <div id="partes-personalizacao"></div>
  </section>

  <!-- üõí CARRINHO -->
  <section class="carrinho">
    <h3>Seu Carrinho</h3>
    <ul id="listaCarrinho"></ul>
    <p><strong>Total:</strong> <span id="total-geral">R$ 0,00</span></p>
    <button class="btn-finalizar" onclick="mostrarFormularioCliente()">Finalizar Pedido</button>
  </section>

  <!-- üìã FORMUL√ÅRIO DO CLIENTE -->
  <section id="form-cliente-container" class="form-cliente-container">
    <h3>üîí Preencha o Formul√°rio</h3>
    <form id="formCliente">
      <input type="text" id="nome" placeholder="Nome completo" required class="campo-texto">
      <div class="mensagem-erro" id="erro-nome">Por favor, insira apenas letras e espa√ßos</div>
      
      <input type="tel" id="cpf_cnpj" placeholder="CPF ou CNPJ (apenas n√∫meros)" required class="campo-numero" pattern="[0-9]*" inputmode="numeric">
      <div class="mensagem-erro" id="erro-cpf_cnpj">Por favor, insira apenas n√∫meros</div>
      
      <input type="tel" id="inscricao_estadual" placeholder="Inscri√ß√£o Estadual (apenas n√∫meros)" class="campo-numero" pattern="[0-9]*" inputmode="numeric">
      <div class="mensagem-erro" id="erro-inscricao_estadual">Por favor, insira apenas n√∫meros</div>
      
      <input type="tel" id="telefone" placeholder="Telefone (apenas n√∫meros)" required class="campo-numero" pattern="[0-9]*" inputmode="numeric">
      <div class="mensagem-erro" id="erro-telefone">Por favor, insira apenas n√∫meros</div>
      
      <input type="tel" id="cep" placeholder="CEP (apenas n√∫meros)" required class="campo-numero" pattern="[0-9]*" inputmode="numeric">
      <div class="mensagem-erro" id="erro-cep">Por favor, insira apenas n√∫meros</div>
      
      <input type="text" id="estado" placeholder="Estado" required class="campo-texto" maxlength="2">
      <div class="mensagem-erro" id="erro-estado">Por favor, insira apenas letras</div>
      
      <input type="text" id="cidade" placeholder="Cidade" required class="campo-texto">
      <div class="mensagem-erro" id="erro-cidade">Por favor, insira apenas letras e espa√ßos</div>
      
      <input type="text" id="bairro" placeholder="Bairro" required class="campo-texto">
      <div class="mensagem-erro" id="erro-bairro">Por favor, insira apenas letras e espa√ßos</div>
      
      <input type="text" id="rua" placeholder="Rua" required class="campo-texto">
      <div class="mensagem-erro" id="erro-rua">Por favor, insira apenas letras, n√∫meros e espa√ßos</div>
      
      <input type="tel" id="numero" placeholder="N√∫mero" required class="campo-numero" pattern="[0-9]*" inputmode="numeric">
      <div class="mensagem-erro" id="erro-numero">Por favor, insira apenas n√∫meros</div>
      
      <button type="button" onclick="validarFormulario()">üì¶ Enviar Pedido via WhatsApp</button>
    </form>
  </section>

  <!-- üé® MODAL DE CORES -->
  <div id="modal-cores" class="modal-cores">
    <div class="modal-conteudo">
      <span class="fechar-modal" id="fechar-modal">&times;</span>
      <h3 id="titulo-modal">Personalize seu Kit</h3>
      <div id="conteudo-modal"></div>
      <div class="resumo-personalizacao" id="resumo-personalizacao"></div>
      <button class="btn-confirmar-cores" onclick="confirmarCores()">Confirmar Sele√ß√£o</button>
    </div>
  </div>

  <!-- ‚òéÔ∏è AJUDA -->
  <button id="btn-ajuda">?</button>
  <div id="popup-ajuda" class="popup-ajuda">
    <p>Precisa de ajuda? Fale com a gente:</p>
    <a href="https://wa.me/5543999999999" class="btn-whatsapp-ajuda" target="_blank">WhatsApp</a>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <script>
    /* =====================================================
       DADOS DOS MATERIAIS E CORES
       ===================================================== */
    const materiais = {
      couro: {
        nome: "Couro Sint√©tico",
        cores: [
          { nome: "Preto Amarelo", imagem: "imagens/cores/pretoamarelo.jpg" },
          { nome: "Azul Marinho", imagem: "imagens/cores/azulmarinho.jpg" },
          { nome: "Couro Vermelho", imagem: "imagens/cores/courovermelho.jpg" },
          { nome: "Preto com Prata", imagem: "imagens/cores/pretocomprata.jpg" },
          { nome: "Preto com Vermelho", imagem: "imagens/cores/pretocomvermelho.jpg" },
          { nome: "Grafite com Grafite", imagem: "imagens/cores/grafitecomgrafite.jpg" },
          { nome: "Marrom Caf√©", imagem: "imagens/cores/marromcafe.jpg" },
          { nome: "Marrom Ferrari", imagem: "imagens/cores/marromferrari.jpg" },
          { nome: "Preto Mosaico", imagem: "imagens/cores/pretomosaico.jpg" },
          { nome: "Preto com Azul", imagem: "imagens/cores/pretocomazul.jpg" },
          { nome: "Bege com Marrom", imagem: "imagens/cores/begecommarrom.jpg" },
          { nome: "Corolla", imagem: "imagens/cores/corolla.jpg" },
          { nome: "Preto com Verde", imagem: "imagens/cores/pretocomverde.jpg" }
        ]
      },
      couro_sport: {
        nome: "Couro Sport",
        cores: [
          { nome: "Preto com Costuras Vermelhas", imagem: "imagens/cores/couromarrom.jpg" },
          { nome: "Azul Racing com Branco", imagem: "imagens/cores/courosportebege.jpg" },
          { nome: "Cinza Metalizado com Laranja", imagem: "imagens/cores/courosportecinzaclaro.jpg" },
          { nome: "Branco Gelado com Preto", imagem: "imagens/cores/courosportecinzaescuro.jpg" }
        ]
      },
      pelucia: {
        nome: "Pel√∫cia (Xinil)",
        cores: [
          { nome: "Grafite Mais Pelinhos", imagem: "imagens/cores/grafite2.jpg" },
          { nome: "Grafite", imagem: "imagens/cores/grafite.jpg" },
          { nome: "Preto Mais Pelinhos", imagem: "imagens/cores/preto2.jpg" },
          { nome: "Preto", imagem: "imagens/cores/preto.jpg" },
          { nome: "Azul Mais Pelinhos", imagem: "imagens/cores/azul.jpg" },
          { nome: "Mescla", imagem: "imagens/cores/mescla.jpg" },
          { nome: "Marrom", imagem: "imagens/cores/marrom.jpg" },
          { nome: "Vermelho Mais Pelinhos", imagem: "imagens/cores/vermelho.jpg" },
          { nome: "Amarelo Mais Pelinhos", imagem: "imagens/cores/amarelo.jpg" },
          { nome: "Verde Mais Pelinhos", imagem: "imagens/cores/verde.jpg" },
          { nome: "Rosa", imagem: "imagens/cores/rosa.jpg" },
          { nome: "Laranja", imagem: "imagens/cores/laranja.jpg" }
        ]
      }
    };

    // Defini√ß√£o dos kits de revestimento - AGORA COM IMAGENS
    const kitsRevestimento = {
      "pelucia_total": {
        nome: "Kit todo na Pel√∫cia (Xinil)",
        descricao: "Todas as partes na pel√∫cia (Xinil)",
        preco: 850,
        imagem: "imagens/kits/kit_pelucia_total.jpg",
        partes: {
          kit: { material: "pelucia", cor: "", corNome: "" }
        }
      },
      "couro_chao_pelucia_resto": {
        nome: "Kit Couro no Ch√£o + Resto na Pel√∫cia (Xinil)",
        descricao: "Ch√£o, Pedais, e Sapateira em couro sint√©tico, demais partes em pel√∫cia (Xinil)",
        preco: 950,
        imagem: "imagens/kits/kit_couro_chao.jpg",
        partes: {
          chao: { material: "couro", cor: "", corNome: "" },
          banco: { material: "pelucia", cor: "", corNome: "" },
          braco: { material: "pelucia", cor: "", corNome: "" },
          cabeca: { material: "pelucia", cor: "", corNome: "" },
          laterais: { material: "pelucia", cor: "", corNome: "" }
        }
      },
      "couro_total": {
        nome: "Couro sint√©tico Sporte no ch√£o + restante na Pel√∫cia (Xinil)",
        descricao: "Ch√£o + pedais + sapateira em couro, restante do kit na pelucia (Xinil)",
        preco: 1000,
        imagem: "imagens/kits/kit_couro_total.jpg",
        partes: {
          chao: { material: "couro", cor: "", corNome: "" },
          banco: { material: "pelucia", cor: "", corNome: "" },
          braco: { material: "pelucia", cor: "", corNome: "" },
          cabeca: { material: "pelucia", cor: "", corNome: "" },
          laterais: { material: "pelucia", cor: "", corNome: "" }
        },
        opcaoChao: true // ‚öôÔ∏è novo campo que ativa o seletor de tipo do ch√£o
      },
      "couro_sport": {
        nome: "Kit Couro com detalhes esportivos ",
        descricao: "Couro sintetico no ch√£o + banco, apoio de bra√ßo e apoio de cabe√ßa no Sued, Restante na Pelucia (Xinil)",
        preco: 1150,
        imagem: "imagens/kits/kit_couro_sport.jpg",
        partes: {
          chao: { material: "couro_sport", cor: "", corNome: "", detalhe: "" },
          banco: { material: "couro_sport", cor: "", corNome: "", detalhe: "" },
          braco: { material: "couro_sport", cor: "", corNome: "", detalhe: "" },
          cabeca: { material: "couro_sport", cor: "", corNome: "", detalhe: "" },
          laterais: { material: "couro_sport", cor: "", corNome: "", detalhe: "" }
        }
      }
    };

    let carrinho = [];
    let maquinaSelecionada = "";
    let kitAtual = null;
    let personalizacaoAtual = {};

    /* =====================================================
       GERA O CARROSSEL DINAMICAMENTE
       ===================================================== */
    function gerarCarrosselKits() {
      const slidesContainer = document.getElementById("slides-kits");
      slidesContainer.innerHTML = "";

      Object.entries(kitsRevestimento).forEach(([key, kit]) => {
        slidesContainer.innerHTML += `
          <div class="swiper-slide" data-kit="${key}">
            <div class="slide-content">
              <img src="${kit.imagem}" alt="${kit.nome}" class="slide-img" loading="lazy">
              <div class="slide-caption">
                <h3>${kit.nome}</h3>
                <p>${kit.descricao}</p>
                <strong style="color:#f9a01b">R$ ${kit.preco.toFixed(2)}</strong><br>
                <button class="btn-selecionar-kit" data-kit="${key}">
                  Selecionar Este Kit
                </button>
              </div>
            </div>
          </div>
        `;
      });

      const swiper = new Swiper(".main-swiper", {
        loop: true,
        slidesPerView: 1,
        spaceBetween: 20,
        centeredSlides: true,
        pagination: { el: ".swiper-pagination", clickable: true },
        navigation: { nextEl: ".swiper-button-next", prevEl: ".swiper-button-prev" },
        autoplay: { delay: 4000, disableOnInteraction: false },
      });

      // Clique no bot√£o ou slide
      document.querySelectorAll(".btn-selecionar-kit").forEach((btn) => {
        btn.addEventListener("click", (e) => {
          e.stopPropagation();
          selecionarKit(btn.dataset.kit);
        });
      });

      document.querySelectorAll(".swiper-slide").forEach((slide) => {
        slide.addEventListener("click", (e) => {
          const kitKey = slide.dataset.kit;
          selecionarKit(kitKey);
        });
      });
    }

    /* =====================================================
       AO CLICAR EM UM KIT DO CARROSSEL
       ===================================================== */
    function selecionarKit(chave) {
      const kit = kitsRevestimento[chave];
      if (!kit) return;

      kitAtual = { ...kit, chave: chave };
      personalizacaoAtual = JSON.parse(JSON.stringify(kit.partes));

      // Mostrar modal de personaliza√ß√£o
      mostrarModalPersonalizacao();
    }

    /* =====================================================
       MODAL DE PERSONALIZA√á√ÉO
       ===================================================== */
    function mostrarModalPersonalizacao() {
      const modal = document.getElementById("modal-cores");
      const conteudoModal = document.getElementById("conteudo-modal");
      
      // Limpar conte√∫do anterior
      conteudoModal.innerHTML = "";
      
      // T√≠tulo do modal
      document.getElementById("titulo-modal").textContent = `Personalize: ${kitAtual.nome}`;
      
      // Gerar se√ß√µes para cada parte do kit
      Object.entries(kitAtual.partes).forEach(([parte, config]) => {
        const material = materiais[config.material];
        if (!material) return;
        
        const parteDiv = document.createElement("div");
        parteDiv.className = "parte-personalizacao";
        
        parteDiv.innerHTML = `
          <div class="parte-titulo">${obterNomeParte(parte)} - ${material.nome}</div>
          <div class="opcoes-materiais" id="opcoes-${parte}"></div>
        `;
        
        conteudoModal.appendChild(parteDiv);
        
        // Gerar op√ß√µes de cores para esta parte
        const opcoesDiv = document.getElementById(`opcoes-${parte}`);
        material.cores.forEach(cor => {
          const corCard = document.createElement("div");
          corCard.className = "material-card";
          corCard.dataset.parte = parte;
          corCard.dataset.cor = cor.nome;
          corCard.dataset.imagem = cor.imagem;
          
          corCard.innerHTML = `
            <img src="${cor.imagem}" alt="${cor.nome}" onerror="this.src='https://via.placeholder.com/120x80/333/fff?text=Imagem+N√£o+Encontrada'">
            <span>${cor.nome}</span>
          `;
          
          corCard.addEventListener("click", () => selecionarCor(parte, cor.nome, cor.imagem));
          opcoesDiv.appendChild(corCard);
        });
      });
      
      // Adicionar seletor de tipo de ch√£o se necess√°rio
      if (kitAtual.opcaoChao) {
        const seletorChao = document.createElement("div");
        seletorChao.className = "seletor-chao";
        seletorChao.innerHTML = `
          <label for="tipo-chao">Tipo do Ch√£o:</label>
          <select id="tipo-chao" onchange="atualizarTipoChao(this.value)">
            <option value="couro">Couro Sint√©tico</option>
            <option value="couro_sport">Couro Sport</option>
          </select>
        `;
        conteudoModal.appendChild(seletorChao);
      }
      
      // Mostrar modal
      modal.style.display = "flex";
      
      // Atualizar resumo
      atualizarResumoPersonalizacao();
    }

    function obterNomeParte(parte) {
      const nomes = {
        kit: "Kit Completo",
        chao: "Ch√£o",
        banco: "Banco",
        braco: "Apoio de Bra√ßo",
        cabeca: "Apoio de Cabe√ßa",
        laterais: "Laterais"
      };
      return nomes[parte] || parte;
    }

    function selecionarCor(parte, corNome, corImagem) {
      // Atualizar sele√ß√£o na personaliza√ß√£o atual
      personalizacaoAtual[parte].cor = corImagem;
      personalizacaoAtual[parte].corNome = corNome;
      
      // Atualizar visual da sele√ß√£o
      const cards = document.querySelectorAll(`[data-parte="${parte}"]`);
      cards.forEach(card => {
        card.classList.remove("selecionado");
        if (card.dataset.cor === corNome) {
          card.classList.add("selecionado");
        }
      });
      
      // Atualizar resumo
      atualizarResumoPersonalizacao();
    }

    function atualizarTipoChao(tipo) {
      if (personalizacaoAtual.chao) {
        personalizacaoAtual.chao.material = tipo;
        
        // Atualizar op√ß√µes de cores para o ch√£o
        const opcoesChao = document.getElementById("opcoes-chao");
        opcoesChao.innerHTML = "";
        
        const material = materiais[tipo];
        material.cores.forEach(cor => {
          const corCard = document.createElement("div");
          corCard.className = "material-card";
          corCard.dataset.parte = "chao";
          corCard.dataset.cor = cor.nome;
          corCard.dataset.imagem = cor.imagem;
          
          corCard.innerHTML = `
            <img src="${cor.imagem}" alt="${cor.nome}" onerror="this.src='https://via.placeholder.com/120x80/333/fff?text=Imagem+N√£o+Encontrada'">
            <span>${cor.nome}</span>
          `;
          
          corCard.addEventListener("click", () => selecionarCor("chao", cor.nome, cor.imagem));
          opcoesChao.appendChild(corCard);
        });
        
        // Resetar sele√ß√£o do ch√£o
        personalizacaoAtual.chao.cor = "";
        personalizacaoAtual.chao.corNome = "";
      }
    }

    function atualizarResumoPersonalizacao() {
      const resumo = document.getElementById("resumo-personalizacao");
      resumo.innerHTML = "<strong>Resumo da Personaliza√ß√£o:</strong>";
      
      Object.entries(personalizacaoAtual).forEach(([parte, config]) => {
        if (config.corNome) {
          const item = document.createElement("div");
          item.className = "resumo-item";
          item.innerHTML = `
            <span>${obterNomeParte(parte)}:</span>
            <span>${config.corNome}</span>
          `;
          resumo.appendChild(item);
        }
      });
    }

    function confirmarCores() {
      // Verificar se todas as partes foram personalizadas
      const partesNaoSelecionadas = Object.entries(personalizacaoAtual)
        .filter(([parte, config]) => !config.corNome)
        .map(([parte, config]) => obterNomeParte(parte));
      
      if (partesNaoSelecionadas.length > 0) {
        alert(`Por favor, selecione cores para: ${partesNaoSelecionadas.join(", ")}`);
        return;
      }
      
      // Fechar modal
      document.getElementById("modal-cores").style.display = "none";
      
      // Continuar com o fluxo normal
      continuarSelecaoAposPersonalizacao();
    }

    function continuarSelecaoAposPersonalizacao() {
      const secaoSelecao = document.getElementById("selecao-container");
      const personalizacao = document.getElementById("personalizacao-container");
      const carrinhoSection = document.querySelector(".carrinho");
      const form = document.getElementById("form-cliente-container");

      [secaoSelecao, personalizacao, carrinhoSection, form].forEach((el) => {
        el.style.display = "block";
        setTimeout(() => el.classList.add("mostrar"), 50);
      });

      const partesDiv = document.getElementById("partes-personalizacao");
      partesDiv.innerHTML = `
        <p><strong>${kitAtual.nome}</strong></p>
        <p style="color:#ccc">${kitAtual.descricao}</p>
        <div class="resumo-personalizacao">
          <strong>Personaliza√ß√£o Selecionada:</strong>
          ${Object.entries(personalizacaoAtual).map(([parte, config]) => 
            `<div class="resumo-item">
              <span>${obterNomeParte(parte)}:</span>
              <span>${config.corNome}</span>
            </div>`
          ).join('')}
        </div>
        <p><strong>Pre√ßo: R$ ${kitAtual.preco.toFixed(2)}</strong></p>
        <input type="hidden" id="kit-selecionado-chave" value="${kitAtual.chave}">
        <button class="btn-adicionar-carrinho" onclick="adicionarAoCarrinho()">Adicionar ao Carrinho</button>
      `;

      secaoSelecao.scrollIntoView({ behavior: "smooth" });
    }

    // Fechar modal ao clicar no X
    document.getElementById("fechar-modal").addEventListener("click", function() {
      document.getElementById("modal-cores").style.display = "none";
    });

    // Fechar modal ao clicar fora dele
    window.addEventListener("click", function(event) {
      const modal = document.getElementById("modal-cores");
      if (event.target === modal) {
        modal.style.display = "none";
      }
    });

    /* =====================================================
       RESTANTE DO C√ìDIGO (sele√ß√£o de m√°quina, carrinho, formul√°rio)
       ===================================================== */
    function configurarSelecaoMaquina() {
      const itensMaquina = document.querySelectorAll('.maquina-item');
      
      itensMaquina.forEach(item => {
        item.addEventListener('click', function() {
          // Remove sele√ß√£o anterior
          itensMaquina.forEach(i => i.classList.remove('selecionado'));
          
          // Adiciona sele√ß√£o atual
          this.classList.add('selecionado');
          
          // Atualiza m√°quina selecionada
          maquinaSelecionada = this.querySelector('p').textContent;
        });
      });
    }

    function adicionarAoCarrinho() {
      if (!kitAtual) return alert("Selecione um kit primeiro!");

      // Verifica se j√° existe no carrinho
      const existeNoCarrinho = carrinho.some(item => item.chave === kitAtual.chave);
      if (!existeNoCarrinho) {
        carrinho.push({
          chave: kitAtual.chave,
          nome: kitAtual.nome,
          preco: kitAtual.preco,
          descricao: kitAtual.descricao,
          personalizacao: { ...personalizacaoAtual }
        });
        atualizarCarrinho();
        alert("Kit personalizado adicionado ao carrinho!");
      } else {
        alert("Este kit j√° est√° no carrinho!");
      }
    }

    function atualizarCarrinho() {
      const lista = document.getElementById("listaCarrinho");
      lista.innerHTML = "";
      let total = 0;
      
      carrinho.forEach((kit, index) => {
        lista.innerHTML += `
          <li>
            ${kit.nome} - R$ ${kit.preco.toFixed(2)}
            <button class="btn-remover" onclick="removerDoCarrinho(${index})">√ó</button>
          </li>
        `;
        total += kit.preco;
      });
      
      document.getElementById("total-geral").textContent = `R$ ${total.toFixed(2)}`;
    }

    function removerDoCarrinho(index) {
      carrinho.splice(index, 1);
      atualizarCarrinho();
    }

    function mostrarFormularioCliente() {
      if (carrinho.length === 0) {
        alert("Adicione pelo menos um kit ao carrinho antes de finalizar!");
        return;
      }
      
      if (!maquinaSelecionada) {
        alert("Selecione uma m√°quina antes de finalizar!");
        return;
      }
      
      document.getElementById("form-cliente-container").scrollIntoView({ behavior: "smooth" });
    }

    // ... (restante das fun√ß√µes de valida√ß√£o e envio para WhatsApp)

    /* =====================================================
       INICIALIZA√á√ÉO
       ===================================================== */
    document.addEventListener("DOMContentLoaded", () => {
      gerarCarrosselKits();
      configurarSelecaoMaquina();

      // Oculta tudo abaixo do carrossel inicialmente
      document.getElementById("selecao-container").style.display = "none";
      document.getElementById("personalizacao-container").style.display = "none";
      document.querySelector(".carrinho").style.display = "none";
      document.getElementById("form-cliente-container").style.display = "none";

      // Popup ajuda
      const btnAjuda = document.getElementById("btn-ajuda");
      const popup = document.getElementById("popup-ajuda");
      btnAjuda.addEventListener("click", () => {
        popup.style.display = popup.style.display === "block" ? "none" : "block";
      });

      // Menu hamburguer
      const menuToggle = document.getElementById("menu-toggle");
      const menuLinks = document.getElementById("menu-links");
      menuToggle.addEventListener("click", () => {
        menuLinks.classList.toggle("mostrar");
      });
    });
  </script>
</body>
</html>